var Ct=Object.defineProperty,wt=Object.defineProperties;var Ft=Object.getOwnPropertyDescriptors;var qe=Object.getOwnPropertySymbols;var St=Object.prototype.hasOwnProperty,Pt=Object.prototype.propertyIsEnumerable;var Ye=(e,o,n)=>o in e?Ct(e,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[o]=n,P=(e,o)=>{for(var n in o||(o={}))St.call(o,n)&&Ye(e,n,o[n]);if(qe)for(var n of qe(o))Pt.call(o,n)&&Ye(e,n,o[n]);return e},ie=(e,o)=>wt(e,Ft(o));var G=(e,o,n)=>new Promise((f,c)=>{var b=r=>{try{i(n.next(r))}catch(a){c(a)}},s=r=>{try{i(n.throw(r))}catch(a){c(a)}},i=r=>r.done?f(r.value):Promise.resolve(r.value).then(b,s);i((n=n.apply(e,o)).next())});import{A as Z,bO as pe,r as N,j,am as Fe,S as ee,u as d,o as Se,a0 as $,B as k,a1 as E,a6 as D,D as te,ap as ue,ab as se,a4 as K,br as ve,ae as x,J as q,bB as Je,bP as ke,aD as Ae,w as C,H as Pe,a7 as ae,aC as re,aS as me,bQ as Xe,_ as Ze,bR as Te,O as _t,R as Rt,b4 as De,bS as Bt,a9 as Qe,t as _e,ad as J,K as Le,bM as $t,bT as Ot,bm as Me,$ as je,bU as It,bV as kt,P as Ue,W as et,ao as Ce,bA as Tt,bW as Dt,bC as Lt,b0 as tt,bX as Mt,bY as jt,bD as Re,bE as Ut,F as Nt,G as Et,b2 as Be,bq as Gt,a$ as Ne,n as Ee,a5 as Vt,X as zt,s as Wt,T as xt,bf as Ht,b3 as Kt,b1 as qt}from"./vendor.e08ba229.js";/* empty css               *//* empty css               *//* empty css               *//* empty css                *//* empty css              *//* empty css               *//* empty css                *//* empty css                */import{p as _,ad as Ge,_ as ne,b as le,i as W,j as he,am as de,av as Yt,I as nt,aw as Jt,a5 as Xt,a as ot,ao as Zt,B as ge,h as Qt,au as en,w as tn,ax as nn,ac as Ve,ae as at,ay as on,az as an,y as sn,x as ln,aA as rn,ak as un,D as we,aB as be,aC as cn,ai as dn,aD as st,aE as lt}from"./index.5678fbaf.js";import{u as $e,C as fn}from"./index.f6db3164.js";import{g as pn}from"./upload.486231f6.js";/* empty css                *//* empty css                */import{a as rt,B as it,b as ut,u as ct}from"./index.b811b2f1.js";/* empty css                */import{b as mn,P as hn}from"./uuid.1226a91f.js";import{d as gn}from"./download.2b91008f.js";import{S as bn}from"./index.2b7dfa36.js";const yn=Z({name:"ApiRadioGroup",components:{RadioGroup:pe.Group,RadioButton:pe.Button,Radio:pe},props:{api:{type:Function,default:null},params:{type:[Object,String],default:()=>({})},value:{type:[String,Number,Boolean]},isBtn:{type:[Boolean],default:!1},numberToString:_.bool,resultField:_.string.def(""),labelField:_.string.def("label"),valueField:_.string.def("value"),immediate:_.bool.def(!0)},emits:["options-change","change"],setup(e,{emit:o}){const n=N([]),f=N(!1),c=N(!0),b=N([]),s=Ge(),{t:i}=le(),[r]=$e(e),a=j(()=>{const{labelField:h,valueField:t,numberToString:u}=e;return d(n).reduce((F,S)=>{if(S){const w=S[t];F.push(P({label:S[h],value:u?`${w}`:w},Se(S,[h,t])))}return F},[])});Fe(()=>{e.immediate&&l()}),ee(()=>e.params,()=>{!d(c)&&l()},{deep:!0});function l(){return G(this,null,function*(){const h=e.api;if(!(!h||!W(h))){n.value=[];try{f.value=!0;const t=yield h(e.params);if(Array.isArray(t)){n.value=t,p();return}e.resultField&&(n.value=ve(t,e.resultField)||[]),p()}catch(t){console.warn(t)}finally{f.value=!1}}})}function p(){o("options-change",d(a))}function m(h,...t){b.value=t}return{state:r,getOptions:a,attrs:s,loading:f,t:i,handleChange:m,props:e}}});function vn(e,o,n,f,c,b){const s=$("RadioButton"),i=$("Radio"),r=$("RadioGroup");return k(),E(r,K(e.attrs,{value:e.state,"onUpdate:value":o[0]||(o[0]=a=>e.state=a),"button-style":"solid",onChange:e.handleChange}),{default:D(()=>[(k(!0),te(se,null,ue(e.getOptions,a=>(k(),te(se,{key:`${a.value}`},[e.props.isBtn?(k(),E(s,{key:0,value:a.value,disabled:a.disabled},{default:D(()=>[x(q(a.label),1)]),_:2},1032,["value","disabled"])):(k(),E(i,{key:1,value:a.value,disabled:a.disabled},{default:D(()=>[x(q(a.label),1)]),_:2},1032,["value","disabled"]))],64))),128))]),_:1},16,["value","onChange"])}var An=ne(yn,[["render",vn]]);const Cn=Z({name:"RadioButtonGroup",components:{RadioGroup:pe.Group,RadioButton:pe.Button},props:{value:{type:[String,Number,Boolean]},options:{type:Array,default:()=>[]}},setup(e){const o=Ge(),[n]=$e(e),f=j(()=>{const{options:c}=e;return!c||(c==null?void 0:c.length)===0?[]:c.some(s=>he(s))?c.map(s=>({label:s,value:s})):c});return{state:n,getOptions:f,attrs:o}}});function wn(e,o,n,f,c,b){const s=$("RadioButton"),i=$("RadioGroup");return k(),E(i,K(e.attrs,{value:e.state,"onUpdate:value":o[0]||(o[0]=r=>e.state=r),"button-style":"solid"}),{default:D(()=>[(k(!0),te(se,null,ue(e.getOptions,r=>(k(),E(s,{key:`${r.value}`,value:r.value,disabled:r.disabled},{default:D(()=>[x(q(r.label),1)]),_:2},1032,["value","disabled"]))),128))]),_:1},16,["value"])}var Fn=ne(Cn,[["render",wn]]);const Sn=Z({name:"ApiSelect",components:{Select:Je,LoadingOutlined:ke},inheritAttrs:!1,props:{value:[Array,Object,String,Number],numberToString:_.bool,api:{type:Function,default:null},params:{type:Object,default:()=>({})},resultField:_.string.def(""),labelField:_.string.def("label"),valueField:_.string.def("value"),immediate:_.bool.def(!0)},emits:["options-change","change"],setup(e,{emit:o}){const n=N([]),f=N(!1),c=N(!0),b=N([]),s=Ge(),{t:i}=le(),[r]=$e(e,"value","change",b),a=j(()=>{const{labelField:t,valueField:u,numberToString:F}=e;return d(n).reduce((S,w)=>{if(w){const R=w[u];S.push(ie(P({},Se(w,[t,u])),{label:w[t],value:F?`${R}`:R}))}return S},[])});Fe(()=>{e.immediate&&l()}),ee(()=>e.params,()=>{!d(c)&&l()},{deep:!0});function l(){return G(this,null,function*(){const t=e.api;if(!(!t||!W(t))){n.value=[];try{f.value=!0;const u=yield t(e.params);if(Array.isArray(u)){n.value=u,m();return}e.resultField&&(n.value=ve(u,e.resultField)||[]),m()}catch(u){console.warn(u)}finally{f.value=!1}}})}function p(){return G(this,null,function*(){!e.immediate&&d(c)&&(yield l(),c.value=!1)})}function m(){o("options-change",d(a))}function h(t,...u){b.value=u}return{state:r,attrs:s,getOptions:a,loading:f,t:i,handleFetch:p,handleChange:h}}});function Pn(e,o,n,f,c,b){const s=$("LoadingOutlined"),i=$("Select");return k(),E(i,K({onDropdownVisibleChange:e.handleFetch},e.$attrs,{onChange:e.handleChange,options:e.getOptions,value:e.state,"onUpdate:value":o[0]||(o[0]=r=>e.state=r)}),Ae({_:2},[ue(Object.keys(e.$slots),r=>({name:r,fn:D(a=>[ae(e.$slots,r,re(me(a||{})))])})),e.loading?{name:"suffixIcon",fn:D(()=>[C(s,{spin:""})])}:void 0,e.loading?{name:"notFoundContent",fn:D(()=>[Pe("span",null,[C(s,{spin:"",class:"mr-1"}),x(" "+q(e.t("component.form.apiSelectNotFound")),1)])])}:void 0]),1040,["onDropdownVisibleChange","onChange","options","value"])}var _n=ne(Sn,[["render",Pn]]);const Rn=Z({name:"ApiTreeSelect",components:{ATreeSelect:Xe,LoadingOutlined:ke},props:{api:{type:Function},params:{type:Object},immediate:{type:Boolean,default:!0},resultField:_.string.def("")},emits:["options-change","change"],setup(e,{attrs:o,emit:n}){const f=N([]),c=N(!1),b=N(!1),s=j(()=>P(P({},e.api?{treeData:d(f)}:{}),o));function i(...a){n("change",...a)}ee(()=>e.params,()=>{!d(c)&&r()},{deep:!0}),ee(()=>e.immediate,a=>{a&&!c.value&&r()}),Ze(()=>{e.immediate&&r()});function r(){return G(this,null,function*(){const{api:a}=e;if(!a||!W(a))return;b.value=!0,f.value=[];let l;try{l=yield a(e.params)}catch(p){console.error(p)}b.value=!1,!!l&&(de(l)||(l=ve(l,e.resultField)),f.value=l||[],c.value=!0,n("options-change",f.value))})}return{getAttrs:s,loading:b,handleChange:i}}});function Bn(e,o,n,f,c,b){const s=$("LoadingOutlined"),i=$("a-tree-select");return k(),E(i,K(e.getAttrs,{onChange:e.handleChange}),Ae({_:2},[ue(Object.keys(e.$slots),r=>({name:r,fn:D(a=>[ae(e.$slots,r,re(me(a||{})))])})),e.loading?{name:"suffixIcon",fn:D(()=>[C(s,{spin:""})])}:void 0]),1040,["onChange"])}var $n=ne(Rn,[["render",Bn]]);const On=Z({name:"ApiCascader",components:{LoadingOutlined:ke,[Te.name]:Te},props:{value:{type:Array},api:{type:Function,default:null},numberToString:_.bool,resultField:_.string.def(""),labelField:_.string.def("label"),valueField:_.string.def("value"),childrenField:_.string.def("children"),asyncFetchParamKey:_.string.def("parentCode"),immediate:_.bool.def(!0),initFetchParams:{type:Object,default:()=>({})},isLeaf:{type:Function,default:null},displayRenderArray:{type:Array}},emits:["change","defaultChange"],setup(e,{emit:o}){const n=N([]),f=N([]),c=N(!1),b=N([]),s=N(!0),[i]=$e(e,"value","change",b);ee(n,h=>{const t=r(h);f.value=t},{deep:!0});function r(h){const{labelField:t,valueField:u,numberToString:F,childrenField:S,isLeaf:w}=e;return h.reduce((R,B)=>{if(B){const V=B[u],y=ie(P({},Se(B,[t,u])),{label:B[t],value:F?`${V}`:V,isLeaf:w&&typeof w=="function"?w(B):!1}),v=Reflect.get(B,S);v&&Reflect.set(y,S,r(v)),R.push(y)}return R},[])}function a(){return G(this,null,function*(){const h=e.api;if(!(!h||!W(h))){n.value=[],c.value=!0;try{const t=yield h(e.initFetchParams);if(Array.isArray(t)){n.value=t;return}e.resultField&&(n.value=ve(t,e.resultField)||[])}catch(t){console.warn(t)}finally{c.value=!1}}})}function l(h){return G(this,null,function*(){const t=h[h.length-1];t.loading=!0;const u=e.api;if(!(!u||!W(u)))try{const F=yield u({[e.asyncFetchParamKey]:Reflect.get(t,"value")});if(Array.isArray(F)){const S=r(F);t.children=S;return}if(e.resultField){const S=r(ve(F,e.resultField)||[]);t.children=S}}catch(F){console.error(F)}finally{t.loading=!1}})}Fe(()=>{e.immediate&&a()}),ee(()=>e.initFetchParams,()=>{!d(s)&&a()},{deep:!0});function p(h,t){b.value=h,o("defaultChange",h,t)}function m({labels:h,selectedOptions:t}){return d(b).length===t.length?h.join(" / "):e.displayRenderArray?e.displayRenderArray.join(" / "):""}return{state:i,options:f,loading:c,handleChange:p,loadData:l,handleRenderDisplay:m}}});function In(e,o,n,f,c,b){const s=$("LoadingOutlined"),i=$("a-cascader");return k(),E(i,{value:e.state,"onUpdate:value":o[0]||(o[0]=r=>e.state=r),options:e.options,"load-data":e.loadData,"change-on-select":"",onChange:e.handleChange,displayRender:e.handleRenderDisplay},Ae({_:2},[e.loading?{name:"suffixIcon",fn:D(()=>[C(s,{spin:""})])}:void 0,e.loading?{name:"notFoundContent",fn:D(()=>[Pe("span",null,[C(s,{spin:"",class:"mr-1"}),x(" "+q(e.t("component.form.apiSelectNotFound")),1)])])}:void 0]),1032,["value","options","load-data","onChange","displayRender"])}var kn=ne(On,[["render",In]]);const{t:ze}=le();function Tn({acceptRef:e,helpTextRef:o,maxNumberRef:n,maxSizeRef:f}){const c=j(()=>{const i=d(e);return i&&i.length>0?i:[]}),b=j(()=>d(c).map(i=>(console.log(i),i.indexOf("/")>0||i.startsWith(".")?i:`.${i}`)).join(",")),s=j(()=>{const i=d(o);if(i)return i;const r=[],a=d(e);a.length>0&&r.push(ze("component.upload.accept",[a.join(",")]));const l=d(f);l&&r.push(ze("component.upload.maxSize",[l]));const p=d(n);return p&&p!==1/0&&r.push(ze("component.upload.maxNumber",[p])),r.join("\uFF0C")});return{getAccept:c,getStringAccept:b,getHelpText:s}}var Y;(function(e){e.SUCCESS="success",e.ERROR="error",e.UPLOADING="uploading"})(Y||(Y={}));const dt={helpText:{type:String,default:""},maxSize:{type:Number,default:2},maxNumber:{type:Number,default:1/0},accept:{type:Array,default:()=>[]},multiple:{type:Boolean,default:!0},uploadParams:{type:Object,default:{}},api:{type:Function,default:null,required:!0},name:{type:String,default:"file"},filename:{type:String,default:null}},Dn=ie(P({value:{type:Array,default:()=>[]}},dt),{showPreviewNumber:{type:Boolean,default:!0},emptyHidePreview:{type:Boolean,default:!1}}),Ln={value:{type:Array,default:()=>[]}},Mn={columns:{type:[Array],default:null},actionColumn:{type:Object,default:null},dataSource:{type:Array,default:null}};function jn(e){return ft(e.name)}function ft(e){return/\.(jpg|jpeg|png|gif)$/i.test(e)}function Un(e){return new Promise((o,n)=>{const f=new FileReader;f.readAsDataURL(e),f.onload=()=>o({result:f.result,file:e}),f.onerror=c=>n(c)})}const pt=Symbol("basic-table");function Qo(e){Rt(pt,e)}function Nn(){return _t(pt)}const{table:En}=Yt,{pageSizeOptions:Gn,defaultPageSize:Vn,fetchSetting:zn,defaultSize:Wn,defaultSortFn:xn,defaultFilterFn:Hn}=En,ea="key",ta=Gn,na=Vn,oa=zn,aa=Wn,sa=xn,la=Hn,ra="center",ia="INDEX",Kn="ACTION";const qn=Z({name:"TableAction",components:{Icon:nt,PopConfirmButton:Jt,Divider:De,Dropdown:Xt,MoreOutlined:Bt,Tooltip:Qe},props:{actions:{type:Array,default:null},dropDownActions:{type:Array,default:null},divider:_.bool.def(!0),outside:_.bool,stopButtonPropagation:_.bool.def(!1)},setup(e){const{prefixCls:o}=ot("basic-table-action");let n={};e.outside||(n=Nn());const{hasPermission:f}=Zt();function c(l){const p=l.ifShow;let m=!0;return ge(p)&&(m=p),W(p)&&(m=p(l)),m}const b=j(()=>(_e(e.actions)||[]).filter(l=>f(l.auth)&&c(l)).map(l=>{const{popConfirm:p}=l;return ie(P(P({getPopupContainer:()=>{var m;return(m=d(n==null?void 0:n.wrapRef.value))!=null?m:document.body},type:"link",size:"small"},l),p||{}),{onConfirm:p==null?void 0:p.confirm,onCancel:p==null?void 0:p.cancel,enable:!!p})})),s=j(()=>(_e(e.dropDownActions)||[]).filter(l=>f(l.auth)&&c(l)).map((l,p)=>{const{label:m,popConfirm:h}=l;return ie(P(P({},l),h),{onConfirm:h==null?void 0:h.confirm,onCancel:h==null?void 0:h.cancel,text:m,divider:p<e.dropDownActions.length-1?e.divider:!1})})),i=j(()=>{var m,h;const p=(((m=n==null?void 0:n.getColumns)==null?void 0:m.call(n))||[]).find(t=>t.flag===Kn);return(h=p==null?void 0:p.align)!=null?h:"left"});function r(l){return P({getPopupContainer:()=>{var p;return(p=d(n==null?void 0:n.wrapRef.value))!=null?p:document.body},placement:"bottom"},he(l)?{title:l}:l)}function a(l){if(!e.stopButtonPropagation)return;l.composedPath().find(h=>{var t;return((t=h.tagName)==null?void 0:t.toUpperCase())==="BUTTON"})&&l.stopPropagation()}return{prefixCls:o,getActions:b,getDropdownList:s,getAlign:i,onCellClick:a,getTooltip:r}}});function Yn(e,o,n,f,c,b){const s=$("Icon"),i=$("PopConfirmButton"),r=$("Tooltip"),a=$("Divider"),l=$("MoreOutlined"),p=$("a-button"),m=$("Dropdown");return k(),te("div",{class:Le([e.prefixCls,e.getAlign]),onClick:o[0]||(o[0]=(...h)=>e.onCellClick&&e.onCellClick(...h))},[(k(!0),te(se,null,ue(e.getActions,(h,t)=>(k(),te(se,{key:`${t}-${h.label}`},[h.tooltip?(k(),E(r,re(K({key:0},e.getTooltip(h.tooltip))),{default:D(()=>[C(i,re(me(h)),{default:D(()=>[h.icon?(k(),E(s,{key:0,icon:h.icon,class:Le({"mr-1":!!h.label})},null,8,["icon","class"])):J("",!0),h.label?(k(),te(se,{key:1},[x(q(h.label),1)],64)):J("",!0)]),_:2},1040)]),_:2},1040)):(k(),E(i,re(K({key:1},h)),{default:D(()=>[h.icon?(k(),E(s,{key:0,icon:h.icon,class:Le({"mr-1":!!h.label})},null,8,["icon","class"])):J("",!0),h.label?(k(),te(se,{key:1},[x(q(h.label),1)],64)):J("",!0)]),_:2},1040)),e.divider&&t<e.getActions.length-1?(k(),E(a,{key:2,type:"vertical",class:"action-divider"})):J("",!0)],64))),128)),e.dropDownActions&&e.getDropdownList.length>0?(k(),E(m,{key:0,trigger:["hover"],dropMenuList:e.getDropdownList,popconfirm:""},{default:D(()=>[ae(e.$slots,"more"),e.$slots.more?J("",!0):(k(),E(p,{key:0,type:"link",size:"small"},{default:D(()=>[C(l,{class:"icon-more"})]),_:1}))]),_:3},8,["dropMenuList"])):J("",!0)],2)}var mt=ne(qn,[["render",Yn]]);const Jn=Z({components:{Image:$t},props:{fileUrl:_.string.def(""),fileName:_.string.def("")}}),Xn={class:"thumb"};function Zn(e,o,n,f,c,b){const s=$("Image");return k(),te("span",Xn,[e.fileUrl?(k(),E(s,{key:0,src:e.fileUrl,width:104},null,8,["src"])):J("",!0)])}var ht=ne(Jn,[["render",Zn]]);const{t:Q}=le();function Qn(){return[{dataIndex:"thumbUrl",title:Q("component.upload.legend"),width:100,customRender:({record:e})=>{const{thumbUrl:o}=e||{};return o&&C(ht,{fileUrl:o},null)}},{dataIndex:"name",title:Q("component.upload.fileName"),align:"left",customRender:({text:e,record:o})=>{const{percent:n,status:f}=o||{};let c="normal";return f===Y.ERROR?c="exception":f===Y.UPLOADING?c="active":f===Y.SUCCESS&&(c="success"),C("span",null,[C("p",{class:"truncate mb-1",title:e},[e]),C(Ot,{percent:n,size:"small",status:c},null)])}},{dataIndex:"size",title:Q("component.upload.fileSize"),width:100,customRender:({text:e=0})=>e&&(e/1024).toFixed(2)+"KB"},{dataIndex:"status",title:Q("component.upload.fileStatue"),width:100,customRender:({text:e})=>e===Y.SUCCESS?C(Me,{color:"green"},{default:()=>Q("component.upload.uploadSuccess")}):e===Y.ERROR?C(Me,{color:"red"},{default:()=>Q("component.upload.uploadError")}):e===Y.UPLOADING?C(Me,{color:"blue"},{default:()=>Q("component.upload.uploading")}):e}]}function eo(e){return{width:120,title:Q("component.upload.operating"),dataIndex:"action",fixed:!1,customRender:({record:o})=>{const n=[{label:Q("component.upload.del"),color:"error",onClick:e.bind(null,o)}];return C(mt,{actions:n,outside:!0},null)}}}function to(){return[{dataIndex:"url",title:Q("component.upload.legend"),width:100,customRender:({record:e})=>{const{url:o}=e||{};return ft(o)&&C(ht,{fileUrl:o},null)}},{dataIndex:"name",title:Q("component.upload.fileName"),align:"left"}]}function no({handleRemove:e,handleDownload:o}){return{width:160,title:Q("component.upload.operating"),dataIndex:"action",fixed:!1,customRender:({record:n})=>{const f=[{label:Q("component.upload.del"),color:"error",onClick:e.bind(null,n)},{label:Q("component.upload.download"),onClick:o.bind(null,n)}];return C(mt,{actions:f,outside:!0},null)}}}var gt=Z({name:"FileList",props:Mn,setup(e){const o=rt();return ee(()=>e.dataSource,()=>{je(()=>{var n;(n=o==null?void 0:o.redoModalHeight)==null||n.call(o)})}),()=>{const{columns:n,actionColumn:f,dataSource:c}=e,b=[...n,f];return C("table",{class:"file-table"},[C("colgroup",null,[b.map(s=>{const{width:i=0,dataIndex:r}=s,a={width:`${i}px`,minWidth:`${i}px`};return C("col",{style:i?a:{},key:r},null)})]),C("thead",null,[C("tr",{class:"file-table-tr"},[b.map(s=>{const{title:i="",align:r="center",dataIndex:a}=s;return C("th",{class:["file-table-th",r],key:a},[i])})])]),C("tbody",null,[c.map((s={},i)=>C("tr",{class:"file-table-tr",key:`${i+s.name||""}`},[b.map(r=>{const{dataIndex:a="",customRender:l,align:p="center"}=r,m=l&&W(l);return C("td",{class:["file-table-td",p],key:a},[m?l==null?void 0:l({text:s[a],record:s}):s[a]])})]))])])}}});const oo=Z({components:{BasicModal:it,Upload:It,Alert:kt,FileList:gt},props:ie(P({},dt),{previewFileList:{type:Array,default:()=>[]}}),emits:["change","register","delete"],setup(e,{emit:o}){const n=Ue({fileList:[]}),f=N(!1),c=N([]),{accept:b,helpText:s,maxNumber:i,maxSize:r}=et(e),{t:a}=le(),[l,{closeModal:p}]=ut(),{getStringAccept:m,getHelpText:h}=Tn({acceptRef:b,helpTextRef:s,maxNumberRef:i,maxSizeRef:r}),{createMessage:t}=Qt(),u=j(()=>c.value.length>0&&!c.value.every(A=>A.status===Y.SUCCESS)),F=j(()=>{const A=c.value.some(g=>g.status===Y.SUCCESS);return{disabled:f.value||c.value.length===0||!A}}),S=j(()=>{const A=c.value.some(g=>g.status===Y.ERROR);return f.value?a("component.upload.uploading"):a(A?"component.upload.reUploadFailed":"component.upload.startUpload")});function w(A){console.log("file",A);const{size:g,name:T}=A,{maxSize:O}=e;if(O&&A.size/1024/1024>=O)return t.error(a("component.upload.maxSizeMultiple",[O])),!1;const z={uuid:mn(),file:A,size:g,name:T,percent:0,type:T.split(".").pop()};return jn(A)?Un(A).then(({result:I})=>{c.value=[...d(c),P({thumbUrl:I},z)]}):c.value=[...d(c),z],console.log(c.value),!1}function R(A){const g=c.value.findIndex(T=>T.uuid===A.uuid);g!==-1&&c.value.splice(g,1),o("delete",A)}function B(A){return G(this,null,function*(){var T;const{api:g}=e;if(!g||!W(g))return en("upload api must exist and be a function");try{A.status=Y.UPLOADING;const{token:O,key:z}=yield pn(P({fileName:A.name},e.uploadParams||{})),{data:I}=yield(T=e.api)==null?void 0:T.call(e,{data:{token:O,key:z},file:A.file,name:e.name,filename:e.filename},function(H){const ce=H.loaded/H.total*100|0;A.percent=ce});return A.status=Y.SUCCESS,A.responseData=I,{success:!0,error:null}}catch(O){return console.log(O),A.status=Y.ERROR,{success:!1,error:O}}})}function V(){return G(this,null,function*(){var g;const{maxNumber:A}=e;if(c.value.length+((g=e.previewFileList)==null?void 0:g.length)>A)return t.warning(a("component.upload.maxNumber",[A]));try{f.value=!0;const T=c.value.filter(I=>I.status!==Y.SUCCESS)||[],O=yield Promise.all(T.map(I=>B(I)));f.value=!1;const z=O.filter(I=>!I.success);if(z.length>0)throw z}catch(T){throw f.value=!1,T}})}function y(){const{maxNumber:A}=e;if(c.value.length>A)return t.warning(a("component.upload.maxNumber",[A]));if(f.value)return t.warning(a("component.upload.saveWarn"));const g=[];for(const T of c.value){const{status:O,responseData:z}=T;O===Y.SUCCESS&&z&&g.push(z.url)}if(g.length<=0)return t.warning(a("component.upload.saveError"));c.value=[],p(),o("change",g)}function v(){return G(this,null,function*(){return f.value?(t.warning(a("component.upload.uploadWait")),!1):(c.value=[],!0)})}return{columns:Qn(),actionColumn:eo(R),register:l,closeModal:p,getHelpText:h,getStringAccept:m,getOkButtonProps:F,beforeUpload:w,fileListRef:c,state:n,isUploadingRef:f,handleStartUpload:V,handleOk:y,handleCloseFunc:v,getIsSelectFile:u,getUploadBtnText:S,t:a}}}),ao={class:"upload-modal-toolbar"};function so(e,o,n,f,c,b){const s=$("a-button"),i=$("Alert"),r=$("Upload"),a=$("FileList"),l=$("BasicModal");return k(),E(l,K({width:"800px",title:e.t("component.upload.upload"),okText:e.t("component.upload.save")},e.$attrs,{onRegister:e.register,onOk:e.handleOk,closeFunc:e.handleCloseFunc,maskClosable:!1,keyboard:!1,wrapClassName:"upload-modal",okButtonProps:e.getOkButtonProps,cancelButtonProps:{disabled:e.isUploadingRef}}),{centerFooter:D(()=>[C(s,{onClick:e.handleStartUpload,color:"success",disabled:!e.getIsSelectFile,loading:e.isUploadingRef},{default:D(()=>[x(q(e.getUploadBtnText),1)]),_:1},8,["onClick","disabled","loading"])]),default:D(()=>[Pe("div",ao,[C(i,{message:e.getHelpText,type:"info",banner:"",class:"upload-modal-toolbar__text"},null,8,["message"]),C(r,{accept:e.getStringAccept,multiple:e.multiple,"before-upload":e.beforeUpload,class:"upload-modal-toolbar__btn"},{default:D(()=>[C(s,{type:"primary"},{default:D(()=>[x(q(e.t("component.upload.choose")),1)]),_:1})]),_:1},8,["accept","multiple","before-upload"])]),C(a,{dataSource:e.fileListRef,columns:e.columns,actionColumn:e.actionColumn},null,8,["dataSource","columns","actionColumn"])]),_:1},16,["title","okText","onRegister","onOk","closeFunc","okButtonProps","cancelButtonProps"])}var lo=ne(oo,[["render",so]]);const ro=Z({components:{BasicModal:it,FileList:gt},props:Ln,emits:["list-change","register","delete"],setup(e,{emit:o}){const n=hn.MEDIA_CNJM_TOP,[f,{closeModal:c}]=ut(),{t:b}=le(),s=N([]);ee(()=>e.value,a=>{de(a)||(a=[]),s.value=a.filter(l=>!!l).map(l=>({url:n+l,type:l.split(".").pop()||"",name:l.split("/").pop()||""}))},{immediate:!0});function i(a){const l=s.value.findIndex(p=>p.url===a.url);if(l!==-1){const p=s.value.splice(l,1);o("delete",p[0].url),o("list-change",s.value.map(m=>m.url))}}function r(a){const{url:l=""}=a;gn({url:l})}return{t:b,register:f,closeModal:c,fileListRef:s,columns:to(),actionColumn:no({handleRemove:i,handleDownload:r})}}});function io(e,o,n,f,c,b){const s=$("FileList"),i=$("BasicModal");return k(),E(i,K({width:"800px",title:e.t("component.upload.preview"),wrapClassName:"upload-preview-modal"},e.$attrs,{onRegister:e.register,showOkBtn:!1}),{default:D(()=>[C(s,{dataSource:e.fileListRef,columns:e.columns,actionColumn:e.actionColumn},null,8,["dataSource","columns","actionColumn"])]),_:1},16,["title","onRegister"])}var uo=ne(ro,[["render",io]]);const co=Z({name:"BasicUpload",components:{UploadModal:lo,UploadPreviewModal:uo,Icon:nt,Tooltip:Qe},props:Dn,emits:["change","delete","preview-delete","update:value"],setup(e,{emit:o,attrs:n}){const{t:f}=le(),[c,{openModal:b}]=ct(),[s,{openModal:i}]=ct(),r=N([]),a=j(()=>{const{emptyHidePreview:u}=e;return u&&u?r.value.length>0:!0}),l=j(()=>{const u=P(P({},n),e);return Se(u,"onChange")});ee(()=>e.value,(u=[])=>{r.value=de(u)?u:[]},{immediate:!0});function p(u){r.value=[...d(r),...u||[]],o("update:value",r.value),o("change",r.value)}function m(u){r.value=[...u||[]],o("update:value",r.value),o("change",r.value)}function h(u){o("delete",u)}function t(u){o("preview-delete",u)}return{registerUploadModal:c,openUploadModal:b,handleChange:p,handlePreviewChange:m,registerPreviewModal:s,openPreviewModal:i,fileList:r,showPreview:a,bindValue:l,handleDelete:h,handlePreviewDelete:t,t:f}}});function fo(e,o,n,f,c,b){const s=$("a-button"),i=$("Icon"),r=$("Tooltip"),a=$("a-button-group"),l=$("UploadModal"),p=$("UploadPreviewModal");return k(),te("div",null,[C(a,null,{default:D(()=>[C(s,{type:"primary",onClick:e.openUploadModal,preIcon:"carbon:cloud-upload"},{default:D(()=>[x(q(e.t("component.upload.upload")),1)]),_:1},8,["onClick"]),e.showPreview?(k(),E(r,{key:0,placement:"bottom"},{title:D(()=>[x(q(e.t("component.upload.uploaded"))+" ",1),e.fileList.length?(k(),te(se,{key:0},[x(q(e.fileList.length),1)],64)):J("",!0)]),default:D(()=>[C(s,{onClick:e.openPreviewModal},{default:D(()=>[C(i,{icon:"bi:eye"}),e.fileList.length&&e.showPreviewNumber?(k(),te(se,{key:0},[x(q(e.fileList.length),1)],64)):J("",!0)]),_:1},8,["onClick"])]),_:1})):J("",!0)]),_:1}),C(l,K(e.bindValue,{previewFileList:e.fileList,onRegister:e.registerUploadModal,onChange:e.handleChange,onDelete:e.handleDelete}),null,16,["previewFileList","onRegister","onChange","onDelete"]),C(p,{value:e.fileList,onRegister:e.registerPreviewModal,onListChange:e.handlePreviewChange,onDelete:e.handlePreviewDelete},null,8,["value","onRegister","onListChange","onDelete"])])}var po=ne(co,[["render",fo]]);const mo=tn(po),L=new Map;L.set("Input",Ce);L.set("InputGroup",Ce.Group);L.set("InputPassword",Ce.Password);L.set("InputSearch",Ce.Search);L.set("InputTextArea",Ce.TextArea);L.set("InputNumber",Tt);L.set("AutoComplete",Dt);L.set("Select",Je);L.set("ApiSelect",_n);L.set("TreeSelect",Xe);L.set("ApiTreeSelect",$n);L.set("ApiRadioGroup",An);L.set("Switch",Lt);L.set("RadioButtonGroup",Fn);L.set("RadioGroup",pe.Group);L.set("Checkbox",tt);L.set("CheckboxGroup",tt.Group);L.set("ApiCascader",kn);L.set("Cascader",Te);L.set("Slider",Mt);L.set("Rate",jt);L.set("DatePicker",Re);L.set("MonthPicker",Re.MonthPicker);L.set("RangePicker",Re.RangePicker);L.set("WeekPicker",Re.WeekPicker);L.set("TimePicker",Ut);L.set("StrengthMeter",bn);L.set("IconPicker",nn);L.set("InputCountDown",fn);L.set("Upload",mo);L.set("Divider",De);const{t:We}=le();function bt(e){return e.includes("Input")||e.includes("Complete")?We("common.inputText"):e.includes("Picker")||e.includes("Select")||e.includes("Cascader")||e.includes("Checkbox")||e.includes("Radio")||e.includes("Switch")?We("common.chooseText"):""}const ho=["DatePicker","MonthPicker","WeekPicker","TimePicker"];function go(){return[...ho,"RangePicker"]}function bo(e,o,n){["DatePicker","MonthPicker","WeekPicker","TimePicker"].includes(o)?e.type=n?"string":"object":["RangePicker","Upload","CheckboxGroup","TimePicker"].includes(o)?e.type="array":["InputNumber"].includes(o)&&(e.type="number")}function yo(e,o){return e&&["Input","InputPassword","InputSearch","InputTextArea"].includes(e)&&o&&Ve(o)?`${o}`:o}const yt=go();function vo(e,o){return j(()=>{const n=d(e),{labelCol:f={},wrapperCol:c={}}=n.itemProps||{},{labelWidth:b,disabledLabelWidth:s}=n,{labelWidth:i,labelCol:r,wrapperCol:a}=d(o);if(!i&&!b&&!r||s)return f.style={textAlign:"left"},{labelCol:f,wrapperCol:c};let l=b||i;const p=P(P({},r),f),m=P(P({},a),c);return l&&(l=Ve(l)?`${l}px`:l),{labelCol:P({style:{width:l}},p),wrapperCol:P({style:{width:`calc(100% - ${l})`}},m)}})}function xe(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Gt(e)}var Ao=Z({name:"BasicFormItem",inheritAttrs:!1,props:{schema:{type:Object,default:()=>({})},formProps:{type:Object,default:()=>({})},allDefaultValues:{type:Object,default:()=>({})},formModel:{type:Object,default:()=>({})},setFormModel:{type:Function,default:null},tableAction:{type:Object},formActionType:{type:Object}},setup(e,{slots:o}){const{t:n}=le(),{schema:f,formProps:c}=et(e),b=vo(f,c),s=j(()=>{const{allDefaultValues:t,formModel:u,schema:F}=e,{mergeDynamicData:S}=e.formProps;return{field:F.field,model:u,values:P(P(P({},S),t),u),schema:F}}),i=j(()=>{var R;const{schema:t,tableAction:u,formModel:F,formActionType:S}=e;let{componentProps:w={}}=t;return W(w)&&(w=(R=w({schema:t,tableAction:u,formModel:F,formActionType:S}))!=null?R:{}),t.component==="Divider"&&(w=Object.assign({type:"horizontal"},w,{orientation:"left",plain:!0})),w}),r=j(()=>{const{disabled:t}=e.formProps,{dynamicDisabled:u}=e.schema,{disabled:F=!1}=d(i);let S=!!t||F;return ge(u)&&(S=u),W(u)&&(S=u(d(s))),S});function a(){const{show:t,ifShow:u}=e.schema,{showAdvancedButton:F}=e.formProps,S=F&&ge(e.schema.isAdvanced)?e.schema.isAdvanced:!0;let w=!0,R=!0;return ge(t)&&(w=t),ge(u)&&(R=u),W(t)&&(w=t(d(s))),W(u)&&(R=u(d(s))),w=w&&S,{isShow:w,isIfShow:R}}function l(){var z;const{rules:t=[],component:u,rulesMessageJoinLabel:F,label:S,dynamicRules:w,required:R}=e.schema;if(W(w))return w(d(s));let B=Ee(t);const{rulesMessageJoinLabel:V}=e.formProps,y=Reflect.has(e.schema,"rulesMessageJoinLabel")?F:V,v=bt(u)+`${y?S:""}`;function A(I,M){const H=I.message||v;return M===void 0||an(M)||Array.isArray(M)&&M.length===0||typeof M=="string"&&M.trim()===""||typeof M=="object"&&Reflect.has(M,"checked")&&Reflect.has(M,"halfChecked")&&Array.isArray(M.checked)&&Array.isArray(M.halfChecked)&&M.checked.length===0&&M.halfChecked.length===0?Promise.reject(H):Promise.resolve()}const g=W(R)?R(d(s)):R;(!B||B.length===0)&&g&&(B=[{required:g,validator:A}]);const T=B.findIndex(I=>Reflect.has(I,"required")&&!Reflect.has(I,"validator"));if(T!==-1){const I=B[T],{isShow:M}=a();if(M||(I.required=!1),u){Reflect.has(I,"type")||(I.type=u==="InputNumber"?"number":"string"),I.message=I.message||v,(u.includes("Input")||u.includes("Textarea"))&&(I.whitespace=!0);const H=(z=d(i))==null?void 0:z.valueFormat;bo(I,u,H)}}const O=B.findIndex(I=>I.max);return O!==-1&&!B[O].validator&&(B[O].message=B[O].message||n("component.form.maxTip",[B[O].max])),B}function p(){var M;const{renderComponentContent:t,component:u,field:F,changeEvent:S="change",valueField:w}=e.schema,R=u&&["Switch","Checkbox"].includes(u),B=`on${Vt(S)}`,V={[B]:(...H)=>{const[ce]=H;g[B]&&g[B](...H);const ye=ce?ce.target:null,Oe=ye?R?ye.checked:ye.value:ce;e.setFormModel(F,Oe)}},y=L.get(u),{autoSetPlaceHolder:v,size:A}=e.formProps,g=ie(P({allowClear:!0,getPopupContainer:H=>H.parentNode,size:A},d(i)),{disabled:d(r)});!g.disabled&&v&&u!=="RangePicker"&&u&&(g.placeholder=((M=d(i))==null?void 0:M.placeholder)||bt(u)),g.codeField=F,g.formValues=d(s);const O={[w||(R?"checked":"value")]:e.formModel[F]},z=P(P(P({},g),V),O);if(!t)return C(y,z,null);const I=W(t)?P({},t(d(s))):{default:()=>t};return C(y,z,xe(I)?I:{default:()=>[I]})}function m(){const{label:t,helpMessage:u,helpComponentProps:F,subLabel:S}=e.schema,w=S?C("span",null,[t,x(" "),C("span",{class:"text-secondary"},[S])]):t,R=W(u)?u(d(s)):u;return!R||Array.isArray(R)&&R.length===0?w:C("span",null,[w,C(on,K({placement:"top",class:"mx-1",text:R},F),null)])}function h(){const{itemProps:t,slot:u,render:F,field:S,suffix:w,component:R}=e.schema,{labelCol:B,wrapperCol:V}=d(b),{colon:y}=e.formProps;if(R==="Divider"){let v;return C(Be,{span:24},{default:()=>[C(De,d(i),xe(v=m())?v:{default:()=>[v]})]})}else{const v=()=>u?at(o,u,d(s)):F?F(d(s)):p(),A=!!w,g=W(w)?w(d(s)):w;return C(Ne.Item,K({name:S,colon:y,class:{"suffix-item":A}},t,{label:m(),rules:l(),labelCol:B,wrapperCol:V}),{default:()=>[C("div",{style:"display:flex"},[C("div",{style:"flex:1;"},[v()]),A&&C("span",{class:"suffix"},[g])])]})}}return()=>{let t;const{colProps:u={},colSlot:F,renderColContent:S,component:w}=e.schema;if(!L.has(w))return null;const{baseColProps:R={}}=e.formProps,B=P(P({},R),u),{isIfShow:V,isShow:y}=a(),v=d(s);return V&&Nt(C(Be,B,xe(t=(()=>F?at(o,F,v):S?S(v):h())())?t:{default:()=>[t]}),[[Et,y]])}}});const vt=Symbol();function Co(e){return ln(e,vt)}function wo(){return sn(vt)}const Fo=Z({name:"BasicFormAction",components:{FormItem:Ne.Item,Button:rn,BasicArrow:un,[Be.name]:Be},props:{showActionButtonGroup:_.bool.def(!0),showResetButton:_.bool.def(!0),showSubmitButton:_.bool.def(!0),showAdvancedButton:_.bool.def(!0),resetButtonOptions:{type:Object,default:()=>({})},submitButtonOptions:{type:Object,default:()=>({})},actionColOptions:{type:Object,default:()=>({})},actionSpan:_.number.def(6),isAdvanced:_.bool,hideAdvanceBtn:_.bool},emits:["toggle-advanced"],setup(e,{emit:o}){const{t:n}=le(),f=j(()=>{const{showAdvancedButton:i,actionSpan:r,actionColOptions:a}=e,l=24-r,p=i?{span:l<6?24:l}:{};return P(P({style:{textAlign:"right"},span:i?6:4},p),a)}),c=j(()=>Object.assign({text:n("common.resetText")},e.resetButtonOptions)),b=j(()=>Object.assign({text:n("common.queryText")},e.submitButtonOptions));function s(){o("toggle-advanced")}return P({t:n,actionColOpt:f,getResetBtnOptions:c,getSubmitBtnOptions:b,toggleAdvanced:s},wo())}});function So(e,o,n,f,c,b){const s=$("Button"),i=$("BasicArrow"),r=$("FormItem"),a=$("a-col");return e.showActionButtonGroup?(k(),E(a,re(K({key:0},e.actionColOpt)),{default:D(()=>[Pe("div",{style:zt([{width:"100%"},{textAlign:e.actionColOpt.style.textAlign}])},[C(r,null,{default:D(()=>[ae(e.$slots,"resetBefore"),e.showResetButton?(k(),E(s,K({key:0,type:"default",class:"mr-2"},e.getResetBtnOptions,{onClick:e.resetAction}),{default:D(()=>[x(q(e.getResetBtnOptions.text),1)]),_:1},16,["onClick"])):J("",!0),ae(e.$slots,"submitBefore"),e.showSubmitButton?(k(),E(s,K({key:1,type:"primary",class:"mr-2"},e.getSubmitBtnOptions,{onClick:e.submitAction}),{default:D(()=>[x(q(e.getSubmitBtnOptions.text),1)]),_:1},16,["onClick"])):J("",!0),ae(e.$slots,"advanceBefore"),e.showAdvancedButton&&!e.hideAdvanceBtn?(k(),E(s,{key:2,type:"link",size:"small",onClick:e.toggleAdvanced},{default:D(()=>[x(q(e.isAdvanced?e.t("component.form.putAway"):e.t("component.form.unfold"))+" ",1),C(i,{class:"ml-1",expand:!e.isAdvanced,up:""},null,8,["expand"])]),_:1},8,["onClick"])):J("",!0),ae(e.$slots,"advanceAfter")]),_:3})],4)]),_:3},16)):J("",!0)}var Po=ne(Fo,[["render",So]]);function _o({defaultValueRef:e,getSchema:o,formModel:n,getProps:f}){function c(i){var a,l;if(!we(i))return{};const r={};for(const p of Object.entries(i)){let[,m]=p;const[h]=p;if(!h||de(m)&&m.length===0||W(m))continue;const t=d(f).transformDateFunc;we(m)&&(m=t==null?void 0:t(m)),de(m)&&((a=m[0])==null?void 0:a._isAMomentObject)&&((l=m[1])==null?void 0:l._isAMomentObject)&&(m=m.map(u=>t==null?void 0:t(u))),he(m)&&(m=m.trim()),Wt(r,h,m)}return b(r)}function b(i){const r=d(f).fieldMapToTime;if(!r||!Array.isArray(r))return i;for(const[a,[l,p],m="YYYY-MM-DD"]of r){if(!a||!l||!p||!i[a])continue;const[h,t]=i[a];i[l]=be(h).format(m),i[p]=be(t).format(m),Reflect.deleteProperty(i,a)}return i}function s(){const i=d(o),r={};i.forEach(a=>{const{defaultValue:l}=a;cn(l)||(r[a.field]=l,n[a.field]=l)}),e.value=r}return{handleFormValues:c,initDefault:s}}const fe=24;function Ro({advanceState:e,emit:o,getProps:n,getSchema:f,formModel:c,defaultValueRef:b}){const{realWidthRef:s,screenEnum:i,screenRef:r}=dn(),a=j(()=>{if(!e.isAdvanced)return 0;const t=d(n).emptySpan||0;if(Ve(t))return t;if(we(t)){const{span:u=0}=t,F=d(r);return t[F.toLowerCase()]||u||0}return 0}),l=xt(m,30);ee([()=>d(f),()=>e.isAdvanced,()=>d(s)],()=>{const{showAdvancedButton:t}=d(n);t&&l()},{immediate:!0});function p(t,u=0,F=!1){const S=d(s),w=parseInt(t.md)||parseInt(t.xs)||parseInt(t.sm)||t.span||fe,R=parseInt(t.lg)||w,B=parseInt(t.xl)||R,V=parseInt(t.xxl)||B;return S<=i.LG?u+=w:S<i.XL?u+=R:S<i.XXL?u+=B:u+=V,F?(e.hideAdvanceBtn=!1,u<=fe*2?(e.hideAdvanceBtn=!0,e.isAdvanced=!0):u>fe*2&&u<=fe*(d(n).autoAdvancedLine||3)?e.hideAdvanceBtn=!1:e.isLoad||(e.isLoad=!0,e.isAdvanced=!e.isAdvanced),{isAdvanced:e.isAdvanced,itemColSum:u}):u>fe*(d(n).alwaysShowLines||1)?{isAdvanced:e.isAdvanced,itemColSum:u}:{isAdvanced:!0,itemColSum:u}}function m(){let t=0,u=0;const{baseColProps:F={}}=d(n);for(const S of d(f)){const{show:w,colProps:R}=S;let B=!0;if(ge(w)&&(B=w),W(w)&&(B=w({schema:S,model:c,field:S.field,values:P(P({},d(b)),c)})),B&&(R||F)){const{itemColSum:V,isAdvanced:y}=p(P(P({},F),R),t);t=V||0,y&&(u=t),S.isAdvanced=y}}e.actionSpan=u%fe+d(a),p(d(n).actionColOptions||{span:fe},t,!0),o("advanced-change")}function h(){e.isAdvanced=!e.isAdvanced}return{handleToggleAdvanced:h}}function Bo({emit:e,getProps:o,formModel:n,getSchema:f,defaultValueRef:c,formElRef:b,schemaRef:s,handleFormValues:i}){function r(){return G(this,null,function*(){const{resetFunc:y,submitOnReset:v}=d(o);y&&W(y)&&(yield y()),!!d(b)&&(Object.keys(n).forEach(g=>{n[g]=c.value[g]}),R(),e("reset",_e(n)),v&&V())})}function a(y){return G(this,null,function*(){const v=d(f).map(g=>g.field).filter(Boolean),A=[];Object.keys(y).forEach(g=>{const T=d(f).find(I=>I.field===g);let O=y[g];const z=Reflect.has(y,g);if(O=yo(T==null?void 0:T.component,O),z&&v.includes(g)){if(F(g))if(Array.isArray(O)){const I=[];for(const M of O)I.push(M?be(M):null);n[g]=I}else{const{componentProps:I}=T||{};let M=I;typeof I=="function"&&(M=M({formModel:n})),n[g]=O?(M==null?void 0:M.valueFormat)?O:be(O):null}else n[g]=O;A.push(g)}}),S(A).catch(g=>{})})}function l(y){return G(this,null,function*(){const v=Ee(d(f));if(!y)return;let A=he(y)?[y]:y;he(y)&&(A=[y]);for(const g of A)p(g,v);s.value=v})}function p(y,v){if(he(y)){const A=v.findIndex(g=>g.field===y);A!==-1&&(delete n[y],v.splice(A,1))}}function m(y,v,A=!1){return G(this,null,function*(){const g=Ee(d(f)),T=g.findIndex(O=>O.field===v);if(!v||T===-1||A){A?g.unshift(y):g.push(y),s.value=g;return}T!==-1&&g.splice(T+1,0,y),s.value=g})}function h(y){return G(this,null,function*(){let v=[];if(we(y)&&v.push(y),de(y)&&(v=[...y]),!v.every(g=>g.component==="Divider"||Reflect.has(g,"field")&&g.field)){st("All children of the form Schema array that need to be updated must contain the `field` field");return}s.value=v})}function t(y){return G(this,null,function*(){let v=[];if(we(y)&&v.push(y),de(y)&&(v=[...y]),!v.every(T=>T.component==="Divider"||Reflect.has(T,"field")&&T.field)){st("All children of the form Schema array that need to be updated must contain the `field` field");return}const g=[];v.forEach(T=>{d(f).forEach(O=>{if(O.field===T.field){const z=lt(O,T);g.push(z)}else g.push(O)})}),s.value=Ht(g,"field")})}function u(){return d(b)?i(_e(d(n))):{}}function F(y){return d(f).some(v=>v.field===y?yt.includes(v.component):!1)}function S(y){return G(this,null,function*(){var v;return(v=d(b))==null?void 0:v.validateFields(y)})}function w(y){return G(this,null,function*(){var v;return yield(v=d(b))==null?void 0:v.validate(y)})}function R(y){return G(this,null,function*(){var v;yield(v=d(b))==null?void 0:v.clearValidate(y)})}function B(y,v){return G(this,null,function*(){var A;yield(A=d(b))==null?void 0:A.scrollToField(y,v)})}function V(y){return G(this,null,function*(){y&&y.preventDefault();const{submitFunc:v}=d(o);if(v&&W(v)){yield v();return}if(!!d(b))try{const g=yield w(),T=i(g);e("submit",T)}catch(g){throw new Error(g)}})}return{handleSubmit:V,clearValidate:R,validate:w,validateFields:S,getFieldsValue:u,updateSchema:t,resetSchema:h,appendSchemaByField:m,removeSchemaByFiled:l,resetFields:r,setFieldsValue:a,scrollToField:B}}function $o(c){return G(this,arguments,function*({getSchema:e,getProps:o,formElRef:n,isInitedDefault:f}){Fe(()=>G(this,null,function*(){if(d(f)||!d(o).autoFocusFirstItem)return;yield je();const b=d(e),s=d(n),i=s==null?void 0:s.$el;if(!s||!i||!b||b.length===0||!b[0].component.includes("Input"))return;const a=i.querySelector(".ant-row:first-child input");!a||a==null||a.focus()}))})}const Oo={model:{type:Object,default:{}},labelWidth:{type:[Number,String],default:0},fieldMapToTime:{type:Array,default:()=>[]},compact:_.bool,schemas:{type:[Array],default:()=>[]},mergeDynamicData:{type:Object,default:null},baseRowStyle:{type:Object},baseColProps:{type:Object},autoSetPlaceHolder:_.bool.def(!0),autoSubmitOnEnter:_.bool.def(!1),submitOnReset:_.bool,size:_.oneOf(["default","small","large"]).def("default"),disabled:_.bool,emptySpan:{type:[Number,Object],default:0},showAdvancedButton:_.bool,transformDateFunc:{type:Function,default:e=>e._isAMomentObject?e==null?void 0:e.format("YYYY-MM-DD HH:mm:ss"):e},rulesMessageJoinLabel:_.bool.def(!0),autoAdvancedLine:_.number.def(3),alwaysShowLines:_.number.def(1),showActionButtonGroup:_.bool.def(!0),actionColOptions:Object,showResetButton:_.bool.def(!0),autoFocusFirstItem:_.bool,resetButtonOptions:Object,showSubmitButton:_.bool.def(!0),submitButtonOptions:Object,resetFunc:Function,submitFunc:Function,hideRequiredMark:_.bool,labelCol:Object,layout:_.oneOf(["horizontal","vertical","inline"]).def("horizontal"),tableAction:{type:Object},wrapperCol:Object,colon:_.bool,labelAlign:_.string,rowProps:Object};const Io=Z({name:"BasicForm",components:{FormItem:Ao,Form:Ne,Row:Kt,FormAction:Po},props:Oo,emits:["advanced-change","reset","submit","register"],setup(e,{emit:o,attrs:n}){const f=Ue({}),c=rt(),b=Ue({isAdvanced:!0,hideAdvanceBtn:!1,isLoad:!1,actionSpan:6}),s=N({}),i=N(!1),r=N({}),a=N(null),l=N(null),{prefixCls:p}=ot("basic-form"),m=j(()=>P(P({},e),d(r))),h=j(()=>[p,{[`${p}--compact`]:d(m).compact}]),t=j(()=>{const{baseRowStyle:U={},rowProps:X}=d(m);return P({style:U},X)}),u=j(()=>P(P(P({},n),e),d(m))),F=j(()=>{const U=d(a)||d(m).schemas;for(const X of U){const{defaultValue:oe,component:He}=X;if(oe&&yt.includes(He))if(!Array.isArray(oe))X.defaultValue=be(oe);else{const Ke=[];oe.forEach(At=>{Ke.push(be(At))}),X.defaultValue=Ke}}return d(m).showAdvancedButton?U.filter(X=>X.component!=="Divider"):U}),{handleToggleAdvanced:S}=Ro({advanceState:b,emit:o,getProps:m,getSchema:F,formModel:f,defaultValueRef:s}),{handleFormValues:w,initDefault:R}=_o({getProps:m,defaultValueRef:s,getSchema:F,formModel:f});$o({getSchema:F,getProps:m,isInitedDefault:i,formElRef:l});const{handleSubmit:B,setFieldsValue:V,clearValidate:y,validate:v,validateFields:A,getFieldsValue:g,updateSchema:T,resetSchema:O,appendSchemaByField:z,removeSchemaByFiled:I,resetFields:M,scrollToField:H}=Bo({emit:o,getProps:m,formModel:f,getSchema:F,defaultValueRef:s,formElRef:l,schemaRef:a,handleFormValues:w});Co({resetAction:M,submitAction:B}),ee(()=>d(m).model,()=>{const{model:U}=d(m);!U||V(U)},{immediate:!0}),ee(()=>d(m).schemas,U=>{O(U!=null?U:[])}),ee(()=>F.value,U=>{je(()=>{var X;(X=c==null?void 0:c.redoModalHeight)==null||X.call(c)}),!d(i)&&(U==null?void 0:U.length)&&(R(),i.value=!0)});function ce(U){return G(this,null,function*(){r.value=lt(d(r)||{},U)})}function ye(U,X){f[U]=X;const{validateTrigger:oe}=d(u);(!oe||oe==="change")&&A([U]).catch(He=>{})}function Oe(U){const{autoSubmitOnEnter:X}=d(m);if(!!X&&U.key==="Enter"&&U.target&&U.target instanceof HTMLElement){const oe=U.target;oe&&oe.tagName&&oe.tagName.toUpperCase()=="INPUT"&&B()}}const Ie={getFieldsValue:g,setFieldsValue:V,resetFields:M,updateSchema:T,resetSchema:O,setProps:ce,removeSchemaByFiled:I,appendSchemaByField:z,clearValidate:y,validateFields:A,validate:v,submit:B,scrollToField:H};return Ze(()=>{R(),o("register",Ie)}),P({getBindValue:u,handleToggleAdvanced:S,handleEnterPress:Oe,formModel:f,defaultValueRef:s,advanceState:b,getRow:t,getProps:m,formElRef:l,getSchema:F,formActionType:Ie,setFormModel:ye,getFormClass:h,getFormActionBindProps:j(()=>P(P({},m.value),b))},Ie)}});function ko(e,o,n,f,c,b){const s=$("FormItem"),i=$("FormAction"),r=$("Row"),a=$("Form");return k(),E(a,K(e.getBindValue,{class:e.getFormClass,ref:"formElRef",model:e.formModel,onKeypress:qt(e.handleEnterPress,["enter"])}),{default:D(()=>[C(r,re(me(e.getRow)),{default:D(()=>[ae(e.$slots,"formHeader"),(k(!0),te(se,null,ue(e.getSchema,l=>(k(),E(s,{key:l.field,tableAction:e.tableAction,formActionType:e.formActionType,schema:l,formProps:e.getProps,allDefaultValues:e.defaultValueRef,formModel:e.formModel,setFormModel:e.setFormModel},Ae({_:2},[ue(Object.keys(e.$slots),p=>({name:p,fn:D(m=>[ae(e.$slots,p,re(me(m||{})))])}))]),1032,["tableAction","formActionType","schema","formProps","allDefaultValues","formModel","setFormModel"]))),128)),C(i,K(e.getFormActionBindProps,{onToggleAdvanced:e.handleToggleAdvanced}),Ae({_:2},[ue(["resetBefore","submitBefore","advanceBefore","advanceAfter"],l=>({name:l,fn:D(p=>[ae(e.$slots,l,re(me(p||{})))])}))]),1040,["onToggleAdvanced"]),ae(e.$slots,"formFooter")]),_:3},16)]),_:3},16,["class","model","onKeypress"])}var ua=ne(Io,[["render",ko]]);export{_n as A,ua as B,ra as D,oa as F,ia as I,na as P,ea as R,mt as T,ta as a,$n as b,Kn as c,sa as d,la as e,aa as f,Qo as g,mo as h,Nn as u};
