var v=Object.defineProperty,y=Object.defineProperties;var D=Object.getOwnPropertyDescriptors;var C=Object.getOwnPropertySymbols;var P=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable;var E=(u,o,e)=>o in u?v(u,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):u[o]=e,f=(u,o)=>{for(var e in o||(o={}))P.call(o,e)&&E(u,e,o[e]);if(C)for(var e of C(o))T.call(o,e)&&E(u,e,o[e]);return u},b=(u,o)=>y(u,D(o));var F=(u,o,e)=>new Promise((l,r)=>{var p=t=>{try{i(e.next(t))}catch(d){r(d)}},n=t=>{try{i(e.throw(t))}catch(d){r(d)}},i=t=>t.done?l(t.value):Promise.resolve(t.value).then(p,n);i((e=e.apply(u,o)).next())});import{B as x,b as S}from"./index.b811b2f1.js";import{B as j}from"./BasicForm.b5d6094e.js";import{u as G}from"./useForm.5db1be8a.js";import{u as O}from"./upload.486231f6.js";import{U,a as g,e as $,b as k}from"./uploadEnum.0c123c22.js";import{_ as R,h as L}from"./index.5678fbaf.js";import{A as W,r as B,j as q,u as c,a0 as h,B as z,a1 as N,a6 as V,w as Y,a4 as H}from"./vendor.e08ba229.js";const le=[{title:"\u5546\u54C1\u7C7B\u578BID",dataIndex:"id",width:120},{title:"\u5546\u54C1\u7C7B\u578B\u540D\u79F0",dataIndex:"name",width:180},{title:"\u7236\u7EA7\u5546\u54C1\u7C7B\u578BID",dataIndex:"pid",width:120},{title:"\u7236\u7EA7\u5546\u54C1\u7C7B\u578B\u540D\u79F0",dataIndex:"pname",width:180},{title:"\u7F29\u7565\u56FE",dataIndex:"url",width:180,slots:{customRender:"img"}},{title:"\u66F4\u65B0\u65F6\u95F4",dataIndex:"update_at",width:180},{title:"\u5907\u6CE8",dataIndex:"des"}],re=[{field:"id",label:"ID",component:"Input",labelWidth:80,colProps:{span:4}},{field:"name",label:"\u540D\u79F0",component:"Input",labelWidth:80,colProps:{span:5}},{label:"\u4E0A\u7EA7\u5546\u54C1\u5206\u7C7B",field:"pid",component:"ApiSelect",labelWidth:120,colProps:{span:6},componentProps:{api:g,labelField:"name",valueField:"id",params:{pid:0}}}],J=[{field:"name",label:"\u5546\u54C1\u5206\u7C7B\u540D\u79F0",required:!0,component:"Input"},{field:"url",component:"Upload",label:"\u5546\u54C1\u5206\u7C7B\u56FE\u7247",colProps:{span:16},rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u4E0A\u4F20\u6587\u4EF6"}],componentProps:{api:O,accept:["image/*"],helpText:"image/*\u683C\u5F0F\u5E76\u4E14\u4E0D\u53EF\u5927\u4E8E1M",maxSize:1,maxNumber:1,multiple:!1,uploadParams:{path:U.GOODS_TYPE}}},{label:"\u4E0A\u7EA7\u5546\u54C1\u5206\u7C7B",field:"pid",component:"ApiSelect",componentProps:{api:g,labelField:"name",valueField:"id",placeholder:"\u4E0D\u9009\u5219\u9ED8\u8BA4\u9876\u7EA7\u5546\u54C1\u5206\u7C7B",params:{pid:0}}},{label:"\u5907\u6CE8",field:"des",component:"InputTextArea"}],K=W({name:"GoodsTypeModal",components:{BasicModal:x,BasicForm:j},emits:["success","register"],setup(u,{emit:o}){const e=B(!0),l=B(""),r=B(""),{createMessage:p}=L(),[n,{setFieldsValue:i,updateSchema:t,resetFields:d,validate:A}]=G({labelWidth:120,schemas:J,showActionButtonGroup:!1,actionColOptions:{span:23}}),[w,{setModalProps:m,closeModal:I}]=S(a=>F(this,null,function*(){d(),m({confirmLoading:!1}),e.value=!!(a==null?void 0:a.isUpdate),c(e)&&(Object.keys(a.record).forEach(s=>{a.record[s]||delete a.record[s]}),l.value=a.record.id,r.value=a.record.pid,i(f({},a.record))),t([{field:"password",ifShow:!c(e)}])})),_=q(()=>c(e)?"\u7F16\u8F91\u5546\u54C1\u5206\u7C7B":"\u65B0\u589E\u5546\u54C1\u5206\u7C7B");function M(){return F(this,null,function*(){try{let a=!1;const s=yield A();if(m({confirmLoading:!0}),s.url=s.url[0],s.pid=s.pid||0,c(e)){if(s.pid===l.value)return p.warn("\u4E0A\u7EA7\u5546\u54C1\u5206\u7C7B\u4E0D\u80FD\u662F\u81EA\u8EAB");yield $(b(f({},s),{id:l.value})),a=r.value!==s.pid}else yield k(s),a=s.pid===0;I(),a&&t({field:"pid",componentProps:{params:{pid:0,t:new Date().getTime()}}}),o("success",{isUpdate:a})}finally{m({confirmLoading:!1})}})}return{registerModal:w,registerForm:n,getTitle:_,handleSubmit:M}}});function Q(u,o,e,l,r,p){const n=h("BasicForm"),i=h("BasicModal");return z(),N(i,H(u.$attrs,{onRegister:u.registerModal,title:u.getTitle,onOk:u.handleSubmit}),{default:V(()=>[Y(n,{onRegister:u.registerForm},null,8,["onRegister"])]),_:1},16,["onRegister","title","onOk"])}var X=R(K,[["render",Q]]),ne=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:X});export{X as G,ne as a,le as c,re as s};
